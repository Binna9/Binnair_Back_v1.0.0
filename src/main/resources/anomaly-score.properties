# Anomaly Score 계산 정책 설정
# @see com.bin.anomaly.score.config.AnomalyScoreProperties

# Detect 대상 timeframe (기본: 5m)
anomaly.score.timeframe=5m

# timeframe bar duration (ret 계산용 직전 1봉 포함 조회 등에 사용)
# ISO-8601 duration 형식: PT5M (5분), PT1H (1시간), PT30S (30초) 등
anomaly.score.bar-duration=PT5M

# anomaly_scores 멱등 키의 일부(UNIQUE에 포함) - 기본: z_v1
anomaly.score.score-version=z_v1

# baseline window (days) - 기본: 90
anomaly.score.window-days=90

# warm-up 최소 기준(데이터 부족이면 스킵) - 기본: 7일
anomaly.score.warmup-min-days=7

# warm-up 최소 표본 수 (시간 기반 warmup과 함께 사용)
# 5m 데이터 기준: 7일 * 288봉/일 * 0.7(누락 허용) ≈ 1400
# 설정하지 않으면 warmupMinDays만 사용 (null이면 표본 수 체크 안 함)
# anomaly.score.warmup-min-bars=1400

# late-arrival 재계산을 위한 backfill 구간 (봉 개수)
# candles가 late-arrival로 수정/재확정될 때(특히 is_final이 바뀔 때),
# 동일 ts 재계산을 위해 lastScoreTs 이전 backfillBars만큼 재계산
# 기본값: 0 (late-arrival 재계산 안 함, "final candle은 수정 없다" 정책)
# 권장값: 10~50 (5m 기준 50분~4시간 정도)
anomaly.score.backfill-bars=0

# "최신 봉 흔들림" 방지 안전장치: ts <= now() - lag
# ISO-8601 duration 형식: PT5M (5분)
anomaly.score.final-candle-safety-lag=PT5M

# std 폭발 방지용 eps
anomaly.score.std-eps=1.0E-12

